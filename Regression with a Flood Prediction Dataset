{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "646369bd",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:47.422389Z",
     "iopub.status.busy": "2024-05-06T23:50:47.421951Z",
     "iopub.status.idle": "2024-05-06T23:50:49.903626Z",
     "shell.execute_reply": "2024-05-06T23:50:49.902083Z"
    },
    "papermill": {
     "duration": 2.494606,
     "end_time": "2024-05-06T23:50:49.907350",
     "exception": false,
     "start_time": "2024-05-06T23:50:47.412744",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "8f310e4d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:49.924776Z",
     "iopub.status.busy": "2024-05-06T23:50:49.923900Z",
     "iopub.status.idle": "2024-05-06T23:50:54.295627Z",
     "shell.execute_reply": "2024-05-06T23:50:54.294235Z"
    },
    "papermill": {
     "duration": 4.383921,
     "end_time": "2024-05-06T23:50:54.298898",
     "exception": false,
     "start_time": "2024-05-06T23:50:49.914977",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1117957 entries, 0 to 1117956\n",
      "Data columns (total 22 columns):\n",
      " #   Column                           Non-Null Count    Dtype  \n",
      "---  ------                           --------------    -----  \n",
      " 0   id                               1117957 non-null  int64  \n",
      " 1   MonsoonIntensity                 1117957 non-null  int64  \n",
      " 2   TopographyDrainage               1117957 non-null  int64  \n",
      " 3   RiverManagement                  1117957 non-null  int64  \n",
      " 4   Deforestation                    1117957 non-null  int64  \n",
      " 5   Urbanization                     1117957 non-null  int64  \n",
      " 6   ClimateChange                    1117957 non-null  int64  \n",
      " 7   DamsQuality                      1117957 non-null  int64  \n",
      " 8   Siltation                        1117957 non-null  int64  \n",
      " 9   AgriculturalPractices            1117957 non-null  int64  \n",
      " 10  Encroachments                    1117957 non-null  int64  \n",
      " 11  IneffectiveDisasterPreparedness  1117957 non-null  int64  \n",
      " 12  DrainageSystems                  1117957 non-null  int64  \n",
      " 13  CoastalVulnerability             1117957 non-null  int64  \n",
      " 14  Landslides                       1117957 non-null  int64  \n",
      " 15  Watersheds                       1117957 non-null  int64  \n",
      " 16  DeterioratingInfrastructure      1117957 non-null  int64  \n",
      " 17  PopulationScore                  1117957 non-null  int64  \n",
      " 18  WetlandLoss                      1117957 non-null  int64  \n",
      " 19  InadequatePlanning               1117957 non-null  int64  \n",
      " 20  PoliticalFactors                 1117957 non-null  int64  \n",
      " 21  FloodProbability                 1117957 non-null  float64\n",
      "dtypes: float64(1), int64(21)\n",
      "memory usage: 187.6 MB\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 745305 entries, 0 to 745304\n",
      "Data columns (total 21 columns):\n",
      " #   Column                           Non-Null Count   Dtype\n",
      "---  ------                           --------------   -----\n",
      " 0   id                               745305 non-null  int64\n",
      " 1   MonsoonIntensity                 745305 non-null  int64\n",
      " 2   TopographyDrainage               745305 non-null  int64\n",
      " 3   RiverManagement                  745305 non-null  int64\n",
      " 4   Deforestation                    745305 non-null  int64\n",
      " 5   Urbanization                     745305 non-null  int64\n",
      " 6   ClimateChange                    745305 non-null  int64\n",
      " 7   DamsQuality                      745305 non-null  int64\n",
      " 8   Siltation                        745305 non-null  int64\n",
      " 9   AgriculturalPractices            745305 non-null  int64\n",
      " 10  Encroachments                    745305 non-null  int64\n",
      " 11  IneffectiveDisasterPreparedness  745305 non-null  int64\n",
      " 12  DrainageSystems                  745305 non-null  int64\n",
      " 13  CoastalVulnerability             745305 non-null  int64\n",
      " 14  Landslides                       745305 non-null  int64\n",
      " 15  Watersheds                       745305 non-null  int64\n",
      " 16  DeterioratingInfrastructure      745305 non-null  int64\n",
      " 17  PopulationScore                  745305 non-null  int64\n",
      " 18  WetlandLoss                      745305 non-null  int64\n",
      " 19  InadequatePlanning               745305 non-null  int64\n",
      " 20  PoliticalFactors                 745305 non-null  int64\n",
      "dtypes: int64(21)\n",
      "memory usage: 119.4 MB\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(None, None)"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_ds=pd.read_csv('/kaggle/input/playground-series-s4e5/train.csv')\n",
    "test_ds=pd.read_csv('/kaggle/input/playground-series-s4e5/test.csv')\n",
    "train_ds.info(), test_ds.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "46b5156b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:54.315643Z",
     "iopub.status.busy": "2024-05-06T23:50:54.315238Z",
     "iopub.status.idle": "2024-05-06T23:50:54.355261Z",
     "shell.execute_reply": "2024-05-06T23:50:54.354005Z"
    },
    "papermill": {
     "duration": 0.05127,
     "end_time": "2024-05-06T23:50:54.357789",
     "exception": false,
     "start_time": "2024-05-06T23:50:54.306519",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "count = np.isinf(train_ds).values.sum() \n",
    "count"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ffd68863",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:54.375380Z",
     "iopub.status.busy": "2024-05-06T23:50:54.374984Z",
     "iopub.status.idle": "2024-05-06T23:50:54.759626Z",
     "shell.execute_reply": "2024-05-06T23:50:54.757891Z"
    },
    "papermill": {
     "duration": 0.39642,
     "end_time": "2024-05-06T23:50:54.762298",
     "exception": false,
     "start_time": "2024-05-06T23:50:54.365878",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>MonsoonIntensity</th>\n",
       "      <th>TopographyDrainage</th>\n",
       "      <th>RiverManagement</th>\n",
       "      <th>Deforestation</th>\n",
       "      <th>Urbanization</th>\n",
       "      <th>ClimateChange</th>\n",
       "      <th>DamsQuality</th>\n",
       "      <th>Siltation</th>\n",
       "      <th>AgriculturalPractices</th>\n",
       "      <th>...</th>\n",
       "      <th>DrainageSystems</th>\n",
       "      <th>CoastalVulnerability</th>\n",
       "      <th>Landslides</th>\n",
       "      <th>Watersheds</th>\n",
       "      <th>DeterioratingInfrastructure</th>\n",
       "      <th>PopulationScore</th>\n",
       "      <th>WetlandLoss</th>\n",
       "      <th>InadequatePlanning</th>\n",
       "      <th>PoliticalFactors</th>\n",
       "      <th>FloodProbability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>0.445</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0.450</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.530</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>0.535</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>0.415</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117952</th>\n",
       "      <td>1117952</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0.495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117953</th>\n",
       "      <td>1117953</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>0.480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117954</th>\n",
       "      <td>1117954</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>0.485</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117955</th>\n",
       "      <td>1117955</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>6</td>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0.495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117956</th>\n",
       "      <td>1117956</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>0.560</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1117957 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  MonsoonIntensity  TopographyDrainage  RiverManagement  \\\n",
       "0              0                 5                   8                5   \n",
       "1              1                 6                   7                4   \n",
       "2              2                 6                   5                6   \n",
       "3              3                 3                   4                6   \n",
       "4              4                 5                   3                2   \n",
       "...          ...               ...                 ...              ...   \n",
       "1117952  1117952                 3                   3                4   \n",
       "1117953  1117953                 2                   2                4   \n",
       "1117954  1117954                 7                   3                9   \n",
       "1117955  1117955                 7                   3                3   \n",
       "1117956  1117956                 4                   5                6   \n",
       "\n",
       "         Deforestation  Urbanization  ClimateChange  DamsQuality  Siltation  \\\n",
       "0                    8             6              4            4          3   \n",
       "1                    4             8              8            3          5   \n",
       "2                    7             3              7            1          5   \n",
       "3                    5             4              8            4          7   \n",
       "4                    6             4              4            3          3   \n",
       "...                ...           ...            ...          ...        ...   \n",
       "1117952             10             4              5            5          7   \n",
       "1117953              3             9              5            8          1   \n",
       "1117954              4             6              5            9          1   \n",
       "1117955              7             5              2            3          4   \n",
       "1117956              9             5              5            2          8   \n",
       "\n",
       "         AgriculturalPractices  ...  DrainageSystems  CoastalVulnerability  \\\n",
       "0                            3  ...                5                     3   \n",
       "1                            4  ...                7                     2   \n",
       "2                            4  ...                7                     3   \n",
       "3                            6  ...                2                     4   \n",
       "4                            3  ...                2                     2   \n",
       "...                        ...  ...              ...                   ...   \n",
       "1117952                     10  ...                7                     8   \n",
       "1117953                      3  ...                9                     4   \n",
       "1117954                      3  ...                5                     5   \n",
       "1117955                      6  ...                6                     8   \n",
       "1117956                      4  ...                4                     8   \n",
       "\n",
       "         Landslides  Watersheds  DeterioratingInfrastructure  PopulationScore  \\\n",
       "0                 3           5                            4                7   \n",
       "1                 0           3                            5                3   \n",
       "2                 7           5                            6                8   \n",
       "3                 7           4                            4                6   \n",
       "4                 6           6                            4                1   \n",
       "...             ...         ...                          ...              ...   \n",
       "1117952           7           2                            2                1   \n",
       "1117953           4           3                            7                4   \n",
       "1117954           5           5                            6                5   \n",
       "1117955           5           3                            4                6   \n",
       "1117956           6           5                            5                6   \n",
       "\n",
       "         WetlandLoss  InadequatePlanning  PoliticalFactors  FloodProbability  \n",
       "0                  5                   7                 3             0.445  \n",
       "1                  3                   4                 3             0.450  \n",
       "2                  2                   3                 3             0.530  \n",
       "3                  5                   7                 5             0.535  \n",
       "4                  2                   3                 5             0.415  \n",
       "...              ...                 ...               ...               ...  \n",
       "1117952            4                   6                 4             0.495  \n",
       "1117953            9                   4                 5             0.480  \n",
       "1117954            5                   2                 4             0.485  \n",
       "1117955            7                   6                 4             0.495  \n",
       "1117956            7                   7                 8             0.560  \n",
       "\n",
       "[1117957 rows x 22 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_ds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "09621f26",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:54.784732Z",
     "iopub.status.busy": "2024-05-06T23:50:54.784237Z",
     "iopub.status.idle": "2024-05-06T23:50:54.815333Z",
     "shell.execute_reply": "2024-05-06T23:50:54.814205Z"
    },
    "papermill": {
     "duration": 0.046441,
     "end_time": "2024-05-06T23:50:54.818244",
     "exception": false,
     "start_time": "2024-05-06T23:50:54.771803",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                                 0\n",
       "MonsoonIntensity                   0\n",
       "TopographyDrainage                 0\n",
       "RiverManagement                    0\n",
       "Deforestation                      0\n",
       "Urbanization                       0\n",
       "ClimateChange                      0\n",
       "DamsQuality                        0\n",
       "Siltation                          0\n",
       "AgriculturalPractices              0\n",
       "Encroachments                      0\n",
       "IneffectiveDisasterPreparedness    0\n",
       "DrainageSystems                    0\n",
       "CoastalVulnerability               0\n",
       "Landslides                         0\n",
       "Watersheds                         0\n",
       "DeterioratingInfrastructure        0\n",
       "PopulationScore                    0\n",
       "WetlandLoss                        0\n",
       "InadequatePlanning                 0\n",
       "PoliticalFactors                   0\n",
       "FloodProbability                   0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_ds.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "50e61c8f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:54.837345Z",
     "iopub.status.busy": "2024-05-06T23:50:54.836948Z",
     "iopub.status.idle": "2024-05-06T23:50:56.438473Z",
     "shell.execute_reply": "2024-05-06T23:50:56.437067Z"
    },
    "papermill": {
     "duration": 1.615102,
     "end_time": "2024-05-06T23:50:56.442040",
     "exception": false,
     "start_time": "2024-05-06T23:50:54.826938",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MonsoonIntensity                   0.189098\n",
       "TopographyDrainage                 0.187635\n",
       "RiverManagement                    0.187131\n",
       "Deforestation                      0.184001\n",
       "Urbanization                       0.180861\n",
       "ClimateChange                      0.184761\n",
       "DamsQuality                        0.187996\n",
       "Siltation                          0.186789\n",
       "AgriculturalPractices              0.183366\n",
       "Encroachments                      0.178841\n",
       "IneffectiveDisasterPreparedness    0.183109\n",
       "DrainageSystems                    0.179305\n",
       "CoastalVulnerability               0.177774\n",
       "Landslides                         0.185346\n",
       "Watersheds                         0.181907\n",
       "DeterioratingInfrastructure        0.190007\n",
       "PopulationScore                    0.185890\n",
       "WetlandLoss                        0.183396\n",
       "InadequatePlanning                 0.180968\n",
       "PoliticalFactors                   0.182417\n",
       "FloodProbability                   1.000000\n",
       "Name: FloodProbability, dtype: float64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_ds[train_ds.columns[1:]].corr()['FloodProbability'][ : ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c5348064",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.462930Z",
     "iopub.status.busy": "2024-05-06T23:50:56.462331Z",
     "iopub.status.idle": "2024-05-06T23:50:56.594826Z",
     "shell.execute_reply": "2024-05-06T23:50:56.593055Z"
    },
    "papermill": {
     "duration": 0.146881,
     "end_time": "2024-05-06T23:50:56.597766",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.450885",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_ds=train_ds.drop(['id'],axis=1)\n",
    "test_ds=test_ds.drop(['id'],axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d7630d49",
   "metadata": {
    "papermill": {
     "duration": 0.007692,
     "end_time": "2024-05-06T23:50:56.614397",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.606705",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Memory  optimization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "eb08994d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.634028Z",
     "iopub.status.busy": "2024-05-06T23:50:56.633631Z",
     "iopub.status.idle": "2024-05-06T23:50:56.642390Z",
     "shell.execute_reply": "2024-05-06T23:50:56.640925Z"
    },
    "papermill": {
     "duration": 0.022054,
     "end_time": "2024-05-06T23:50:56.645464",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.623410",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "memory usage before optimization :179.12 MB\n"
     ]
    }
   ],
   "source": [
    "memory_usage=train_ds.memory_usage().sum()/1024**2\n",
    "print(\"memory usage before optimization :{:.2f} MB\".format(memory_usage))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5eab9cfe",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.664908Z",
     "iopub.status.busy": "2024-05-06T23:50:56.664517Z",
     "iopub.status.idle": "2024-05-06T23:50:56.672856Z",
     "shell.execute_reply": "2024-05-06T23:50:56.671583Z"
    },
    "papermill": {
     "duration": 0.021637,
     "end_time": "2024-05-06T23:50:56.675955",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.654318",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "memory usage before optimization :113.72 MB\n"
     ]
    }
   ],
   "source": [
    "memory_usage=test_ds.memory_usage().sum()/1024**2\n",
    "print(\"memory usage before optimization :{:.2f} MB\".format(memory_usage))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c12c8f52",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.693570Z",
     "iopub.status.busy": "2024-05-06T23:50:56.693153Z",
     "iopub.status.idle": "2024-05-06T23:50:56.706417Z",
     "shell.execute_reply": "2024-05-06T23:50:56.704938Z"
    },
    "papermill": {
     "duration": 0.02561,
     "end_time": "2024-05-06T23:50:56.709526",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.683916",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def memory_optimization(data_frame):\n",
    "    memory_usage=data_frame.memory_usage().sum()/1024**2\n",
    "    cols=data_frame.columns\n",
    "    for col in cols:\n",
    "        column_type=data_frame[col].dtype\n",
    "        \n",
    "        if column_type !=object:\n",
    "            col_min=data_frame[col].min()\n",
    "            col_max=data_frame[col].max()\n",
    "            if str(column_type)[:3]=='int':\n",
    "                if col_min > np.iinfo(np.int8).min and col_max< np.iinfo(np.int8).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.int8)\n",
    "                elif col_min > np.iinfo(np.int16).min and col_max< np.iinfo(np.int16).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.int16)\n",
    "                elif col_min > np.iinfo(np.int32).min and col_max< np.iinfo(np.int32).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.int32)\n",
    "                elif col_min > np.iinfo(np.int64).min and col_max< np.iinfo(np.int64).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.int64)\n",
    "            else:\n",
    "                if col_min > np.finfo(np.float16).min and col_max< np.finfo(np.float16).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.float16)\n",
    "                elif col_min > np.finfo(np.float32).min and col_max< np.finfo(np.float32).max:\n",
    "                    data_frame[col]=data_frame[col].astype(np.float32)\n",
    "                else:\n",
    "                    data_frame[col]=data_frame[col].astype(np.float64)\n",
    "        else:\n",
    "            data_frame[col]=data_frame[col].astype('object')\n",
    "    mem_usage=data_frame.memory_usage().sum()/1024**2\n",
    "    print(\"memory usage after optimization is: {:.2f} MB\".format(mem_usage))\n",
    "    print(\"memory usage reduce by: {:.2f}%\".format(100*(memory_usage-mem_usage)/memory_usage))\n",
    "    \n",
    "    return data_frame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "be3ad980",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.731607Z",
     "iopub.status.busy": "2024-05-06T23:50:56.731202Z",
     "iopub.status.idle": "2024-05-06T23:50:56.839828Z",
     "shell.execute_reply": "2024-05-06T23:50:56.838532Z"
    },
    "papermill": {
     "duration": 0.122972,
     "end_time": "2024-05-06T23:50:56.842665",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.719693",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "memory usage after optimization is: 23.46 MB\n",
      "memory usage reduce by: 86.90%\n"
     ]
    }
   ],
   "source": [
    "train=memory_optimization(train_ds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "996ebe3a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.862584Z",
     "iopub.status.busy": "2024-05-06T23:50:56.862092Z",
     "iopub.status.idle": "2024-05-06T23:50:56.930916Z",
     "shell.execute_reply": "2024-05-06T23:50:56.929488Z"
    },
    "papermill": {
     "duration": 0.082648,
     "end_time": "2024-05-06T23:50:56.933587",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.850939",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "memory usage after optimization is: 14.22 MB\n",
      "memory usage reduce by: 87.50%\n"
     ]
    }
   ],
   "source": [
    "test=memory_optimization(test_ds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "52a0c84a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:56.952578Z",
     "iopub.status.busy": "2024-05-06T23:50:56.952163Z",
     "iopub.status.idle": "2024-05-06T23:50:57.050328Z",
     "shell.execute_reply": "2024-05-06T23:50:57.049173Z"
    },
    "papermill": {
     "duration": 0.11094,
     "end_time": "2024-05-06T23:50:57.053021",
     "exception": false,
     "start_time": "2024-05-06T23:50:56.942081",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "target=train['FloodProbability']\n",
    "train=train.drop(['FloodProbability'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "25a0057d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:57.071333Z",
     "iopub.status.busy": "2024-05-06T23:50:57.070823Z",
     "iopub.status.idle": "2024-05-06T23:50:57.806129Z",
     "shell.execute_reply": "2024-05-06T23:50:57.804980Z"
    },
    "papermill": {
     "duration": 0.747442,
     "end_time": "2024-05-06T23:50:57.808691",
     "exception": false,
     "start_time": "2024-05-06T23:50:57.061249",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>MonsoonIntensity</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.921450</td>\n",
       "      <td>2.056387</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TopographyDrainage</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.926671</td>\n",
       "      <td>2.093879</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RiverManagement</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.955322</td>\n",
       "      <td>2.072186</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deforestation</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.942240</td>\n",
       "      <td>2.051689</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Urbanization</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.942517</td>\n",
       "      <td>2.083391</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ClimateChange</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.934093</td>\n",
       "      <td>2.057742</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DamsQuality</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.955878</td>\n",
       "      <td>2.083063</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Siltation</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.927791</td>\n",
       "      <td>2.065992</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AgriculturalPractices</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.942619</td>\n",
       "      <td>2.068545</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Encroachments</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.949230</td>\n",
       "      <td>2.083324</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IneffectiveDisasterPreparedness</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.945239</td>\n",
       "      <td>2.078141</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DrainageSystems</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.946893</td>\n",
       "      <td>2.072333</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CoastalVulnerability</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.953999</td>\n",
       "      <td>2.088899</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Landslides</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.931376</td>\n",
       "      <td>2.078287</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Watersheds</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.929032</td>\n",
       "      <td>2.082395</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DeterioratingInfrastructure</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.925907</td>\n",
       "      <td>2.064813</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PopulationScore</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.927520</td>\n",
       "      <td>2.074176</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WetlandLoss</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.950859</td>\n",
       "      <td>2.068696</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>19.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>InadequatePlanning</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.940587</td>\n",
       "      <td>2.081123</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PoliticalFactors</th>\n",
       "      <td>1117957.0</td>\n",
       "      <td>4.939004</td>\n",
       "      <td>2.090350</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     count      mean       std  min  25%  50%  \\\n",
       "MonsoonIntensity                 1117957.0  4.921450  2.056387  0.0  3.0  5.0   \n",
       "TopographyDrainage               1117957.0  4.926671  2.093879  0.0  3.0  5.0   \n",
       "RiverManagement                  1117957.0  4.955322  2.072186  0.0  4.0  5.0   \n",
       "Deforestation                    1117957.0  4.942240  2.051689  0.0  4.0  5.0   \n",
       "Urbanization                     1117957.0  4.942517  2.083391  0.0  3.0  5.0   \n",
       "ClimateChange                    1117957.0  4.934093  2.057742  0.0  3.0  5.0   \n",
       "DamsQuality                      1117957.0  4.955878  2.083063  0.0  4.0  5.0   \n",
       "Siltation                        1117957.0  4.927791  2.065992  0.0  3.0  5.0   \n",
       "AgriculturalPractices            1117957.0  4.942619  2.068545  0.0  3.0  5.0   \n",
       "Encroachments                    1117957.0  4.949230  2.083324  0.0  4.0  5.0   \n",
       "IneffectiveDisasterPreparedness  1117957.0  4.945239  2.078141  0.0  3.0  5.0   \n",
       "DrainageSystems                  1117957.0  4.946893  2.072333  0.0  4.0  5.0   \n",
       "CoastalVulnerability             1117957.0  4.953999  2.088899  0.0  3.0  5.0   \n",
       "Landslides                       1117957.0  4.931376  2.078287  0.0  3.0  5.0   \n",
       "Watersheds                       1117957.0  4.929032  2.082395  0.0  3.0  5.0   \n",
       "DeterioratingInfrastructure      1117957.0  4.925907  2.064813  0.0  3.0  5.0   \n",
       "PopulationScore                  1117957.0  4.927520  2.074176  0.0  3.0  5.0   \n",
       "WetlandLoss                      1117957.0  4.950859  2.068696  0.0  4.0  5.0   \n",
       "InadequatePlanning               1117957.0  4.940587  2.081123  0.0  3.0  5.0   \n",
       "PoliticalFactors                 1117957.0  4.939004  2.090350  0.0  3.0  5.0   \n",
       "\n",
       "                                 75%   max  \n",
       "MonsoonIntensity                 6.0  16.0  \n",
       "TopographyDrainage               6.0  18.0  \n",
       "RiverManagement                  6.0  16.0  \n",
       "Deforestation                    6.0  17.0  \n",
       "Urbanization                     6.0  17.0  \n",
       "ClimateChange                    6.0  17.0  \n",
       "DamsQuality                      6.0  16.0  \n",
       "Siltation                        6.0  16.0  \n",
       "AgriculturalPractices            6.0  16.0  \n",
       "Encroachments                    6.0  18.0  \n",
       "IneffectiveDisasterPreparedness  6.0  16.0  \n",
       "DrainageSystems                  6.0  17.0  \n",
       "CoastalVulnerability             6.0  17.0  \n",
       "Landslides                       6.0  16.0  \n",
       "Watersheds                       6.0  16.0  \n",
       "DeterioratingInfrastructure      6.0  17.0  \n",
       "PopulationScore                  6.0  18.0  \n",
       "WetlandLoss                      6.0  19.0  \n",
       "InadequatePlanning               6.0  16.0  \n",
       "PoliticalFactors                 6.0  16.0  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.describe().T"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d346b90",
   "metadata": {
    "papermill": {
     "duration": 0.008529,
     "end_time": "2024-05-06T23:50:57.827448",
     "exception": false,
     "start_time": "2024-05-06T23:50:57.818919",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## *preprocess Data*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "7254c199",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:50:57.848237Z",
     "iopub.status.busy": "2024-05-06T23:50:57.847864Z",
     "iopub.status.idle": "2024-05-06T23:51:08.092215Z",
     "shell.execute_reply": "2024-05-06T23:51:08.090783Z"
    },
    "papermill": {
     "duration": 10.258728,
     "end_time": "2024-05-06T23:51:08.095698",
     "exception": false,
     "start_time": "2024-05-06T23:50:57.836970",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "base_columns=['MonsoonIntensity', 'TopographyDrainage', 'RiverManagement',\n",
    "       'Deforestation', 'Urbanization', 'ClimateChange', 'DamsQuality',\n",
    "       'Siltation', 'AgriculturalPractices', 'Encroachments',\n",
    "       'IneffectiveDisasterPreparedness', 'DrainageSystems',\n",
    "       'CoastalVulnerability', 'Landslides', 'Watersheds',\n",
    "       'DeterioratingInfrastructure', 'PopulationScore', 'WetlandLoss',\n",
    "       'InadequatePlanning', 'PoliticalFactors']\n",
    "\n",
    "def add_feature(df):\n",
    "    df['mean']=df[base_columns].mean(axis=1)\n",
    "    df['std']=df[base_columns].std(axis=1)\n",
    "    df['max']=df[base_columns].max(axis=1)\n",
    "    df['min']=df[base_columns].min(axis=1)\n",
    "    df['sum']=df[base_columns].sum(axis=1)\n",
    "    df['amplified_sum']=(df[base_columns]**1.5).max(axis=1)\n",
    "    df['median']=df[base_columns].median(axis=1)\n",
    "    df['range']=df['max']-df['min']\n",
    "    df['max']=df[base_columns].max(axis=1)\n",
    "    df['ptp']=df[base_columns].values.ptp(axis=1)\n",
    "    df['q25']=df[base_columns].quantile(0.25, axis=1)\n",
    "    df['q75']=df[base_columns].quantile(0.75, axis=1)\n",
    "    \n",
    "    return df\n",
    "\n",
    "train= add_feature(train)\n",
    "test=add_feature(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "ad740ecc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:08.115337Z",
     "iopub.status.busy": "2024-05-06T23:51:08.114963Z",
     "iopub.status.idle": "2024-05-06T23:51:08.507727Z",
     "shell.execute_reply": "2024-05-06T23:51:08.506105Z"
    },
    "papermill": {
     "duration": 0.405681,
     "end_time": "2024-05-06T23:51:08.510360",
     "exception": false,
     "start_time": "2024-05-06T23:51:08.104679",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MonsoonIntensity</th>\n",
       "      <th>TopographyDrainage</th>\n",
       "      <th>RiverManagement</th>\n",
       "      <th>Deforestation</th>\n",
       "      <th>Urbanization</th>\n",
       "      <th>ClimateChange</th>\n",
       "      <th>DamsQuality</th>\n",
       "      <th>Siltation</th>\n",
       "      <th>AgriculturalPractices</th>\n",
       "      <th>Encroachments</th>\n",
       "      <th>...</th>\n",
       "      <th>std</th>\n",
       "      <th>max</th>\n",
       "      <th>min</th>\n",
       "      <th>sum</th>\n",
       "      <th>amplified_sum</th>\n",
       "      <th>median</th>\n",
       "      <th>range</th>\n",
       "      <th>ptp</th>\n",
       "      <th>q25</th>\n",
       "      <th>q75</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.750188</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>94</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>4.5</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>3.00</td>\n",
       "      <td>5.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>2.296450</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>94</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1.932411</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>99</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>8</td>\n",
       "      <td>...</td>\n",
       "      <td>1.641565</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>104</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>4.00</td>\n",
       "      <td>6.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>1.500877</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>72</td>\n",
       "      <td>14.696938</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2.75</td>\n",
       "      <td>5.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117952</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>2.543826</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>99</td>\n",
       "      <td>31.622777</td>\n",
       "      <td>4.0</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>3.00</td>\n",
       "      <td>7.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117953</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>2.419221</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>96</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>3.00</td>\n",
       "      <td>5.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117954</th>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.970840</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>98</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>4.00</td>\n",
       "      <td>5.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117955</th>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.700619</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>99</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>3.75</td>\n",
       "      <td>6.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1117956</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>2.013115</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>110</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>4.75</td>\n",
       "      <td>7.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1117957 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         MonsoonIntensity  TopographyDrainage  RiverManagement  Deforestation  \\\n",
       "0                       5                   8                5              8   \n",
       "1                       6                   7                4              4   \n",
       "2                       6                   5                6              7   \n",
       "3                       3                   4                6              5   \n",
       "4                       5                   3                2              6   \n",
       "...                   ...                 ...              ...            ...   \n",
       "1117952                 3                   3                4             10   \n",
       "1117953                 2                   2                4              3   \n",
       "1117954                 7                   3                9              4   \n",
       "1117955                 7                   3                3              7   \n",
       "1117956                 4                   5                6              9   \n",
       "\n",
       "         Urbanization  ClimateChange  DamsQuality  Siltation  \\\n",
       "0                   6              4            4          3   \n",
       "1                   8              8            3          5   \n",
       "2                   3              7            1          5   \n",
       "3                   4              8            4          7   \n",
       "4                   4              4            3          3   \n",
       "...               ...            ...          ...        ...   \n",
       "1117952             4              5            5          7   \n",
       "1117953             9              5            8          1   \n",
       "1117954             6              5            9          1   \n",
       "1117955             5              2            3          4   \n",
       "1117956             5              5            2          8   \n",
       "\n",
       "         AgriculturalPractices  Encroachments  ...       std  max  min  sum  \\\n",
       "0                            3              4  ...  1.750188    8    2   94   \n",
       "1                            4              6  ...  2.296450    9    0   94   \n",
       "2                            4              5  ...  1.932411    8    1   99   \n",
       "3                            6              8  ...  1.641565    8    2  104   \n",
       "4                            3              3  ...  1.500877    6    1   72   \n",
       "...                        ...            ...  ...       ...  ...  ...  ...   \n",
       "1117952                     10              4  ...  2.543826   10    1   99   \n",
       "1117953                      3              5  ...  2.419221    9    1   96   \n",
       "1117954                      3              4  ...  1.970840    9    1   98   \n",
       "1117955                      6              4  ...  1.700619    8    2   99   \n",
       "1117956                      4              5  ...  2.013115    9    1  110   \n",
       "\n",
       "         amplified_sum  median  range  ptp   q25   q75  \n",
       "0            22.627417     4.5      6    6  3.00  5.25  \n",
       "1            27.000000     4.0      9    9  3.00  6.25  \n",
       "2            22.627417     5.0      7    7  3.00  6.25  \n",
       "3            22.627417     5.0      6    6  4.00  6.25  \n",
       "4            14.696938     3.0      5    5  2.75  5.00  \n",
       "...                ...     ...    ...  ...   ...   ...  \n",
       "1117952      31.622777     4.0      9    9  3.00  7.00  \n",
       "1117953      27.000000     4.0      8    8  3.00  5.50  \n",
       "1117954      27.000000     5.0      8    8  4.00  5.25  \n",
       "1117955      22.627417     5.0      6    6  3.75  6.00  \n",
       "1117956      27.000000     5.0      8    8  4.75  7.00  \n",
       "\n",
       "[1117957 rows x 31 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a117102e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:08.533339Z",
     "iopub.status.busy": "2024-05-06T23:51:08.532923Z",
     "iopub.status.idle": "2024-05-06T23:51:08.807904Z",
     "shell.execute_reply": "2024-05-06T23:51:08.806523Z"
    },
    "papermill": {
     "duration": 0.291236,
     "end_time": "2024-05-06T23:51:08.810824",
     "exception": false,
     "start_time": "2024-05-06T23:51:08.519588",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MonsoonIntensity</th>\n",
       "      <th>TopographyDrainage</th>\n",
       "      <th>RiverManagement</th>\n",
       "      <th>Deforestation</th>\n",
       "      <th>Urbanization</th>\n",
       "      <th>ClimateChange</th>\n",
       "      <th>DamsQuality</th>\n",
       "      <th>Siltation</th>\n",
       "      <th>AgriculturalPractices</th>\n",
       "      <th>Encroachments</th>\n",
       "      <th>...</th>\n",
       "      <th>std</th>\n",
       "      <th>max</th>\n",
       "      <th>min</th>\n",
       "      <th>sum</th>\n",
       "      <th>amplified_sum</th>\n",
       "      <th>median</th>\n",
       "      <th>range</th>\n",
       "      <th>ptp</th>\n",
       "      <th>q25</th>\n",
       "      <th>q75</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.605091</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>111</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>5.5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>4.00</td>\n",
       "      <td>7.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.905670</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>90</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>4.00</td>\n",
       "      <td>5.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>6</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>2.259483</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>90</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>4.5</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2.75</td>\n",
       "      <td>6.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>1.602629</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>92</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>4.0</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>4.00</td>\n",
       "      <td>6.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>...</td>\n",
       "      <td>1.602629</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>92</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>4.5</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>3.75</td>\n",
       "      <td>6.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745300</th>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>1.454575</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>94</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>4.00</td>\n",
       "      <td>5.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745301</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>2.089447</td>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>89</td>\n",
       "      <td>41.569219</td>\n",
       "      <td>4.0</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>3.00</td>\n",
       "      <td>5.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745302</th>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>2.339591</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>120</td>\n",
       "      <td>36.482873</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>5.00</td>\n",
       "      <td>7.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745303</th>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>...</td>\n",
       "      <td>1.954078</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>107</td>\n",
       "      <td>22.627417</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>3.75</td>\n",
       "      <td>7.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745304</th>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>...</td>\n",
       "      <td>2.294157</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>100</td>\n",
       "      <td>31.622777</td>\n",
       "      <td>4.5</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>745305 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        MonsoonIntensity  TopographyDrainage  RiverManagement  Deforestation  \\\n",
       "0                      4                   6                3              5   \n",
       "1                      4                   4                2              9   \n",
       "2                      1                   3                6              5   \n",
       "3                      2                   4                4              6   \n",
       "4                      6                   3                2              4   \n",
       "...                  ...                 ...              ...            ...   \n",
       "745300                 5                   4                8              3   \n",
       "745301                 4                   4                2             12   \n",
       "745302                 5                   7                9              5   \n",
       "745303                 4                   7                6              3   \n",
       "745304                 4                   2                5              3   \n",
       "\n",
       "        Urbanization  ClimateChange  DamsQuality  Siltation  \\\n",
       "0                  6              7            8          7   \n",
       "1                  5              5            4          7   \n",
       "2                  7              2            4          6   \n",
       "3                  4              5            4          3   \n",
       "4                  6              4            5          5   \n",
       "...              ...            ...          ...        ...   \n",
       "745300             5              4            4          5   \n",
       "745301             4              3            4          3   \n",
       "745302             5              6            7          5   \n",
       "745303             5              2            3          8   \n",
       "745304             8              4            5          3   \n",
       "\n",
       "        AgriculturalPractices  Encroachments  ...       std  max  min  sum  \\\n",
       "0                           8              4  ...  1.605091    8    3  111   \n",
       "1                           5              4  ...  1.905670    9    1   90   \n",
       "2                           4              2  ...  2.259483    9    1   90   \n",
       "3                           4              4  ...  1.602629    8    2   92   \n",
       "4                           3              7  ...  1.602629    8    2   92   \n",
       "...                       ...            ...  ...       ...  ...  ...  ...   \n",
       "745300                      5              5  ...  1.454575    8    1   94   \n",
       "745301                      5              5  ...  2.089447   12    2   89   \n",
       "745302                      5              3  ...  2.339591   11    3  120   \n",
       "745303                      6              7  ...  1.954078    8    2  107   \n",
       "745304                      5              6  ...  2.294157   10    2  100   \n",
       "\n",
       "        amplified_sum  median  range  ptp   q25   q75  \n",
       "0           22.627417     5.5      5    5  4.00  7.00  \n",
       "1           27.000000     4.0      8    8  4.00  5.00  \n",
       "2           27.000000     4.5      8    8  2.75  6.00  \n",
       "3           22.627417     4.0      6    6  4.00  6.00  \n",
       "4           22.627417     4.5      6    6  3.75  6.00  \n",
       "...               ...     ...    ...  ...   ...   ...  \n",
       "745300      22.627417     5.0      7    7  4.00  5.25  \n",
       "745301      41.569219     4.0     10   10  3.00  5.00  \n",
       "745302      36.482873     5.0      8    8  5.00  7.00  \n",
       "745303      22.627417     6.0      6    6  3.75  7.00  \n",
       "745304      31.622777     4.5      8    8  3.00  6.00  \n",
       "\n",
       "[745305 rows x 31 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "97449f31",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:08.834374Z",
     "iopub.status.busy": "2024-05-06T23:51:08.834005Z",
     "iopub.status.idle": "2024-05-06T23:51:08.844402Z",
     "shell.execute_reply": "2024-05-06T23:51:08.843283Z"
    },
    "papermill": {
     "duration": 0.024646,
     "end_time": "2024-05-06T23:51:08.846815",
     "exception": false,
     "start_time": "2024-05-06T23:51:08.822169",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0          0.445068\n",
       "1          0.449951\n",
       "2          0.529785\n",
       "3          0.535156\n",
       "4          0.415039\n",
       "             ...   \n",
       "1117952    0.495117\n",
       "1117953    0.479980\n",
       "1117954    0.485107\n",
       "1117955    0.495117\n",
       "1117956    0.560059\n",
       "Name: FloodProbability, Length: 1117957, dtype: float16"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ca8484e6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:08.871616Z",
     "iopub.status.busy": "2024-05-06T23:51:08.870535Z",
     "iopub.status.idle": "2024-05-06T23:51:09.862608Z",
     "shell.execute_reply": "2024-05-06T23:51:09.861168Z"
    },
    "papermill": {
     "duration": 1.007894,
     "end_time": "2024-05-06T23:51:09.865354",
     "exception": false,
     "start_time": "2024-05-06T23:51:08.857460",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import MinMaxScaler\n",
    "scaler = MinMaxScaler()\n",
    "train=scaler.fit_transform(train)\n",
    "test=scaler.fit_transform(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "4a1282ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:09.889443Z",
     "iopub.status.busy": "2024-05-06T23:51:09.888784Z",
     "iopub.status.idle": "2024-05-06T23:51:10.794643Z",
     "shell.execute_reply": "2024-05-06T23:51:10.792893Z"
    },
    "papermill": {
     "duration": 0.920959,
     "end_time": "2024-05-06T23:51:10.797423",
     "exception": false,
     "start_time": "2024-05-06T23:51:09.876464",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor, AdaBoostRegressor, GradientBoostingRegressor\n",
    "from catboost import CatBoostRegressor\n",
    "from sklearn.datasets import make_regression\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_squared_error\n",
    "from sklearn.metrics import r2_score\n",
    "from sklearn.model_selection import KFold"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "cf3ac7f9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:51:10.820737Z",
     "iopub.status.busy": "2024-05-06T23:51:10.820323Z",
     "iopub.status.idle": "2024-05-06T23:53:16.203588Z",
     "shell.execute_reply": "2024-05-06T23:53:16.202177Z"
    },
    "papermill": {
     "duration": 125.39866,
     "end_time": "2024-05-06T23:53:16.206795",
     "exception": false,
     "start_time": "2024-05-06T23:51:10.808135",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/numpy/lib/function_base.py:522: RuntimeWarning: overflow encountered in cast\n",
      "  scl = avg_as_array.dtype.type(a.size/avg_as_array.size)\n",
      "/opt/conda/lib/python3.10/site-packages/numpy/lib/function_base.py:522: RuntimeWarning: overflow encountered in cast\n",
      "  scl = avg_as_array.dtype.type(a.size/avg_as_array.size)\n",
      "/opt/conda/lib/python3.10/site-packages/numpy/lib/function_base.py:522: RuntimeWarning: overflow encountered in cast\n",
      "  scl = avg_as_array.dtype.type(a.size/avg_as_array.size)\n",
      "/opt/conda/lib/python3.10/site-packages/numpy/lib/function_base.py:522: RuntimeWarning: overflow encountered in cast\n",
      "  scl = avg_as_array.dtype.type(a.size/avg_as_array.size)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mean R2 score: 0.86738\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/numpy/lib/function_base.py:522: RuntimeWarning: overflow encountered in cast\n",
      "  scl = avg_as_array.dtype.type(a.size/avg_as_array.size)\n"
     ]
    }
   ],
   "source": [
    "#X_train, X_test, y_train, y_test = train_test_split(train, target, test_size=0.2, random_state=42)\n",
    "#rf = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "#ada = AdaBoostRegressor(n_estimators=100, random_state=42)\n",
    "#gb = GradientBoostingRegressor(n_estimators=100, random_state=42)\n",
    "X_train=train\n",
    "y_train=target\n",
    "X_test=test\n",
    "cat = CatBoostRegressor(iterations=100, learning_rate=0.1, verbose=0)\n",
    "cv=KFold(5, shuffle=True, random_state=0)\n",
    "cv_splits=cv.split(X_train, y_train)\n",
    "scores=[]\n",
    "test_preds=[]\n",
    "for train_idx, val_idx in cv_splits:\n",
    "    X_train_Fold, X_Val_Fold=X_train[train_idx],X_train[val_idx]\n",
    "    y_train_Fold, y_Val_Fold=y_train[train_idx],y_train[val_idx]\n",
    "    cat.fit(X_train_Fold,y_train_Fold)\n",
    "    y_val_pred=cat.predict(X_Val_Fold)\n",
    "    r2=r2_score(y_Val_Fold,y_val_pred)\n",
    "    scores.append(r2)\n",
    "    test_pred=cat.predict(X_test)\n",
    "    test_preds.append(test_pred)\n",
    "print(f'Mean R2 score: {np.mean(scores):.5f}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "13fcca42",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:53:16.230984Z",
     "iopub.status.busy": "2024-05-06T23:53:16.230562Z",
     "iopub.status.idle": "2024-05-06T23:53:16.237855Z",
     "shell.execute_reply": "2024-05-06T23:53:16.236754Z"
    },
    "papermill": {
     "duration": 0.022091,
     "end_time": "2024-05-06T23:53:16.240671",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.218580",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "745305"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(test_preds[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "303f5372",
   "metadata": {
    "papermill": {
     "duration": 0.011129,
     "end_time": "2024-05-06T23:53:16.262184",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.251055",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#we already run some model for this data\n",
    "\n",
    "rf Mean Squared Error: 0.0008944333847660526\n",
    "\n",
    "ada Mean Squared Error: 0.0010779311182171059\n",
    "\n",
    "gb Mean Squared Error: 0.0010023522426631348\n",
    "\n",
    "cat Mean Squared Error: 0.0006180235250844109"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "bcc91ee5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:53:16.286193Z",
     "iopub.status.busy": "2024-05-06T23:53:16.285799Z",
     "iopub.status.idle": "2024-05-06T23:53:16.515120Z",
     "shell.execute_reply": "2024-05-06T23:53:16.513963Z"
    },
    "papermill": {
     "duration": 0.245447,
     "end_time": "2024-05-06T23:53:16.518257",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.272810",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>FloodProbability</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1117957</td>\n",
       "      <td>0.573610</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1117958</td>\n",
       "      <td>0.453197</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1117959</td>\n",
       "      <td>0.450085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1117960</td>\n",
       "      <td>0.463644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1117961</td>\n",
       "      <td>0.463683</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745300</th>\n",
       "      <td>1863257</td>\n",
       "      <td>0.468517</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745301</th>\n",
       "      <td>1863258</td>\n",
       "      <td>0.441472</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745302</th>\n",
       "      <td>1863259</td>\n",
       "      <td>0.619680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745303</th>\n",
       "      <td>1863260</td>\n",
       "      <td>0.546519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745304</th>\n",
       "      <td>1863261</td>\n",
       "      <td>0.525517</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>745305 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             id  FloodProbability\n",
       "0       1117957          0.573610\n",
       "1       1117958          0.453197\n",
       "2       1117959          0.450085\n",
       "3       1117960          0.463644\n",
       "4       1117961          0.463683\n",
       "...         ...               ...\n",
       "745300  1863257          0.468517\n",
       "745301  1863258          0.441472\n",
       "745302  1863259          0.619680\n",
       "745303  1863260          0.546519\n",
       "745304  1863261          0.525517\n",
       "\n",
       "[745305 rows x 2 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "submission=pd.read_csv('/kaggle/input/playground-series-s4e5/sample_submission.csv')\n",
    "submission=submission.drop(['FloodProbability'],axis=1)\n",
    "submission['FloodProbability']=np.mean(test_preds, axis=0)\n",
    "submission"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "521e9721",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:53:16.542545Z",
     "iopub.status.busy": "2024-05-06T23:53:16.542115Z",
     "iopub.status.idle": "2024-05-06T23:53:16.547141Z",
     "shell.execute_reply": "2024-05-06T23:53:16.546012Z"
    },
    "papermill": {
     "duration": 0.020162,
     "end_time": "2024-05-06T23:53:16.549427",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.529265",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#submission.to_csv('Submission.csv', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4ac5985",
   "metadata": {
    "papermill": {
     "duration": 0.009929,
     "end_time": "2024-05-06T23:53:16.571102",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.561173",
     "status": "completed"
    },
    "tags": []
   },
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "6ff490ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T23:53:16.593407Z",
     "iopub.status.busy": "2024-05-06T23:53:16.593017Z",
     "iopub.status.idle": "2024-05-06T23:53:16.598744Z",
     "shell.execute_reply": "2024-05-06T23:53:16.597320Z"
    },
    "papermill": {
     "duration": 0.019928,
     "end_time": "2024-05-06T23:53:16.601342",
     "exception": false,
     "start_time": "2024-05-06T23:53:16.581414",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#submission.to_csv('./Submission.csv', index=False)"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 8121328,
     "sourceId": 73278,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 30698,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 153.110891,
   "end_time": "2024-05-06T23:53:17.437224",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-05-06T23:50:44.326333",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
